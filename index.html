<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>üÉè ◊î◊ß◊ú◊§◊ô◊ù ◊©◊ú ◊ú◊ô◊ê◊ù üéÆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            direction: rtl;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(180deg, #87CEEB 0%, #90EE90 30%, #228B22 70%, #006400 100%);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-text-size-adjust: 100%;
        }

        .jungle-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .mountain {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40%;
            background: linear-gradient(135deg, #8B4513, #A0522D, #CD853F);
            clip-path: polygon(0 100%, 20% 60%, 40% 80%, 60% 50%, 80% 70%, 100% 45%, 100% 100%);
        }

        .tree {
            position: absolute;
            bottom: 0;
        }

        .tree1 {
            left: 5%;
            width: 80px;
            height: 150px;
            background: linear-gradient(180deg, #228B22, #32CD32);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
        }

        .tree1::before {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 40px;
            background: #8B4513;
            border-radius: 8px;
        }

        .tree2 {
            right: 10%;
            width: 100px;
            height: 180px;
            background: linear-gradient(180deg, #006400, #228B22);
            border-radius: 50%;
        }

        .tree2::before {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 50px;
            background: #654321;
            border-radius: 10px;
        }

        .tree3 {
            left: 70%;
            width: 60px;
            height: 120px;
            background: linear-gradient(180deg, #32CD32, #90EE90);
            border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
        }

        .tree3::before {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 35px;
            background: #8B4513;
            border-radius: 6px;
        }

        .vine {
            position: absolute;
            width: 8px;
            background: linear-gradient(180deg, #228B22, #32CD32);
            border-radius: 4px;
            animation: vineSwing 4s ease-in-out infinite alternate;
        }

        .vine1 {
            left: 30%;
            top: 20%;
            height: 200px;
            animation-delay: 0s;
        }

        .vine2 {
            right: 25%;
            top: 15%;
            height: 180px;
            animation-delay: 1.5s;
        }

        .vine3 {
            left: 60%;
            top: 25%;
            height: 160px;
            animation-delay: 3s;
        }

        @keyframes vineSwing {
            0% { transform: rotate(-3deg); }
            100% { transform: rotate(3deg); }
        }

        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
            animation: cloudFloat 25s linear infinite;
        }

        .cloud1 {
            top: 10%;
            left: -100px;
            width: 80px;
            height: 40px;
            animation-duration: 30s;
        }

        .cloud2 {
            top: 20%;
            left: -120px;
            width: 100px;
            height: 50px;
            animation-duration: 25s;
            animation-delay: -10s;
        }

        .cloud3 {
            top: 5%;
            left: -80px;
            width: 60px;
            height: 30px;
            animation-duration: 35s;
            animation-delay: -20s;
        }

        @keyframes cloudFloat {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(100vw + 200px)); }
        }

        .grass {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 30px;
            background: linear-gradient(90deg, #228B22, #32CD32, #90EE90, #32CD32, #228B22);
            animation: grassWave 3s ease-in-out infinite;
        }

        @keyframes grassWave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.1) translateY(-3px); }
        }

        .game-container {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
        }

        .game-title {
            font-size: 4em;
            color: #8B4513;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            animation: titleBounce 2s ease-in-out infinite alternate;
        }

        @keyframes titleBounce {
            0% { transform: translateY(0px) scale(1); }
            100% { transform: translateY(-10px) scale(1.05); }
        }

        .subtitle {
            font-size: 1.8em;
            color: #2F4F2F;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.8);
            margin-bottom: 40px;
            background: rgba(255,255,255,0.3);
            padding: 15px 30px;
            border-radius: 25px;
            backdrop-filter: blur(5px);
        }

        .difficulty-buttons {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-top: 20px;
        }

        .difficulty-btn {
            padding: 25px 50px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
            min-width: 300px;
            min-height: 80px;
        }

        .difficulty-btn.easy {
            background: linear-gradient(45deg, #90EE90, #32CD32);
            color: #006400;
        }

        .difficulty-btn.medium {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #8B4513;
        }

        .difficulty-btn.hard {
            background: linear-gradient(45deg, #FF6347, #DC143C);
            color: white;
        }

        .difficulty-btn:active, .game-btn:active, .sound-toggle:active, .card:active {
            transform: scale(0.95);
        }

        .game-screen {
            display: none;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-info {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .info-card {
            background: rgba(255,255,255,0.95);
            padding: 15px 25px;
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            font-size: 1.4em;
            font-weight: bold;
            color: #2F4F2F;
            min-width: 120px;
            text-align: center;
            border: 3px solid #228B22;
        }

        .stars {
            text-align: center;
            margin-bottom: 20px;
            font-size: 3em;
        }

        .star {
            color: #ddd;
            transition: all 0.3s ease;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .star.filled {
            color: #FFD700;
            animation: starGlow 1.5s ease-in-out infinite alternate;
        }

        @keyframes starGlow {
            0% { text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
            100% { text-shadow: 0 0 25px #FFD700, 2px 2px 4px rgba(0,0,0,0.3); }
        }

        .game-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .game-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            min-height: 60px;
            background: linear-gradient(45deg, #9B59B6, #8E44AD);
            color: white;
        }

        .btn-restart {
            background: linear-gradient(45deg, #FF6B35, #FF8C42);
        }

        .game-board {
            display: grid;
            gap: 15px;
            justify-content: center;
            margin: 0 auto;
            padding: 30px;
            background: rgba(139, 69, 19, 0.2);
            border-radius: 30px;
            backdrop-filter: blur(10px);
            border: 4px solid rgba(139, 69, 19, 0.6);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
            max-width: fit-content;
            transition: transform 0.2s ease;
            grid-auto-rows: 1fr;
        }

        .game-board.easy {
            grid-template-columns: repeat(3, minmax(0, 1fr));
        }

        .game-board.medium {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }

        .game-board.hard {
            grid-template-columns: repeat(6, minmax(0, 1fr));
            gap: 16px;
        }

        .card {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #8B4513, #A0522D);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
            border: 4px solid #654321;
            min-height: 90px;
            perspective: 1000px;
            touch-action: manipulation;
            /* ◊î◊°◊® min-width ◊ß◊©◊î ◊ë◊û◊ï◊ë◊ô◊ô◊ú; ◊†◊©◊ê◊® ◊í◊û◊ô◊© */
        }

        .card-inner {
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-back, .card-front {
            width: 100%;
            height: 100%;
            position: absolute;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 16px;
        }

        .card-back {
            background: linear-gradient(145deg, #8B4513, #A0522D);
            background-image:
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.2) 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.15) 1px, transparent 1px);
            color: #654321;
            font-size: 2.5em;
        }

        .card-back::after {
            content: 'üåø';
            font-size: 3em;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
        }

        .card-front {
            background: linear-gradient(145deg, #F5DEB3, #DEB887);
            transform: rotateY(180deg);
            font-size: 4em;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            border: 3px solid #D2691E;
        }

        .card.matched {
            background: linear-gradient(145deg, #90EE90, #98FB98);
            cursor: default;
            animation: matchPulse 1s ease;
        }

        .card.matched .card-front {
            background: linear-gradient(145deg, #90EE90, #98FB98);
            border-color: #228B22;
        }

        @keyframes matchPulse {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-5deg); }
        }

        .victory-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(15px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .victory-content {
            background: linear-gradient(145deg, #FFD700, #FFA500);
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
            border: 5px solid #FF8C00;
            max-width: 90%;
            width: 500px;
            animation: victoryPop 0.8s ease;
            color: #8B4513;
        }

        @keyframes victoryPop {
            0% { transform: scale(0.3) rotate(-15deg); opacity: 0; }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .victory-title {
            font-size: 3.5em;
            margin-bottom: 20px;
            font-weight: bold;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.3);
        }

        .victory-stars {
            font-size: 4em;
            margin-bottom: 25px;
        }

        .victory-stats {
            font-size: 1.6em;
            margin-bottom: 35px;
            line-height: 1.8;
        }

        .victory-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s ease;
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .sound-toggle.muted {
            background: rgba(255,100,100,0.9);
        }

        .signature {
            position: fixed;
            bottom: 20px;
            left: 20px;
            font-size: 1.2em;
            color: rgba(255,255,255,0.9);
            font-weight: bold;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            z-index: 1000;
            background: rgba(139, 69, 19, 0.4);
            padding: 10px 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        @media (max-width: 768px) {
            .game-title {
                font-size: 2.6em;
            }

            .difficulty-btn {
                font-size: 1.4em;
                padding: 18px 35px;
                min-width: 260px;
            }

            .game-header {
                margin-bottom: 16px;
                transform: scale(0.85);
                transform-origin: top center;
            }

            .game-info {
                display: flex;
                flex-wrap: nowrap;
                gap: 6px;
                justify-content: center;
                margin-bottom: 6px;
                overflow-x: auto;
            }

            .info-card {
                font-size: 0.95em;
                padding: 6px 10px;
                min-width: 80px;
                border-radius: 14px;
                border: 2px solid #228B22;
                line-height: 1.1;
            }

            .stars {
                font-size: 2em;
                margin-bottom: 6px;
            }

            .game-controls {
                display: flex;
                flex-wrap: nowrap;
                gap: 8px;
                justify-content: center;
                margin-bottom: 16px;
            }

            .game-controls .game-btn {
                padding: 9px 18px;
                font-size: 12px;
                min-height: 44px;
            }

            .game-board {
                transform: none;
                padding: 8px;
                gap: 14px;
                max-width: calc(100vw - 20px);
                width: 100%;
                box-sizing: border-box;
            }

            .game-board.easy {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }

            .game-board.medium {
                grid-template-columns: repeat(4, minmax(0, 1fr));
            }

            .game-board.hard {
                grid-template-columns: repeat(4, minmax(0, 1fr));
            }

            .card {
                min-height: 90px;
                width: 100%;
            }

            .card-front {
                font-size: 3em;
            }

            .victory-content {
                padding: 35px;
                width: 95%;
            }

            .victory-title {
                font-size: 2.8em;
            }

            .signature {
                font-size: 1em;
                padding: 8px 15px;
            }
        }

        @media (max-width: 480px) {
            .game-title {
                font-size: 2.2em;
            }

            .difficulty-btn {
                font-size: 1.3em;
                padding: 18px 35px;
                min-width: 250px;
            }

            .game-info {
                gap: 6px;
            }

            .info-card {
                padding: 6px 10px;
                font-size: 0.9em;
                min-width: 80px;
            }

            .game-board {
                gap: 10px;
                padding: 15px;
            }

            .card {
                min-height: 95px;
                width: 100%;
            }

            .card-front {
                font-size: 3em;
            }

            .signature {
                font-size: 1em;
                padding: 8px 15px;
            }

            .game-controls .game-btn {
                padding: 8px 16px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="jungle-bg">
        <div class="mountain"></div>
        <div class="tree tree1"></div>
        <div class="tree tree2"></div>
        <div class="tree tree3"></div>
        <div class="vine vine1"></div>
        <div class="vine vine2"></div>
        <div class="vine vine3"></div>
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>
        <div class="cloud cloud3"></div>
        <div class="grass"></div>
    </div>

    <button class="sound-toggle" id="soundToggle" title="◊õ◊ë◊î/◊î◊§◊¢◊ú ◊°◊ê◊ï◊†◊ì">üîä</button>

    <div class="game-container">
        <div class="start-screen" id="startScreen">
            <h1 class="game-title">üÉè ◊î◊ß◊ú◊§◊ô◊ù ◊©◊ú ◊ú◊ô◊ê◊ù üéÆ</h1>
            <p class="subtitle">◊î◊™◊ê◊ô◊û◊ï ◊ó◊ô◊ï◊™ ◊°◊§◊ê◊®◊ô ◊ï◊ñ◊õ◊ï ◊ë◊ó◊ï◊ï◊ô◊ô◊™ ◊ó◊ß◊® ◊ò◊ë◊¢ ◊û◊ì◊ú◊ô◊ß◊î! üåø</p>
            <div class="difficulty-buttons">
                <button class="difficulty-btn easy" data-difficulty="easy">
                    üå± ◊°◊§◊ê◊®◊ô ◊ß◊ú<br><small style="font-size:0.7em;">12 ◊ß◊ú◊§◊ô◊ù - ◊û◊ï◊©◊ú◊ù ◊ú◊û◊í◊ú◊î ◊î◊¶◊¢◊ô◊®!</small>
                </button>
                <button class="difficulty-btn medium" data-difficulty="medium">
                    üå≥ ◊°◊§◊ê◊®◊ô ◊ë◊ô◊†◊ï◊†◊ô<br><small style="font-size:0.7em;">16 ◊ß◊ú◊§◊ô◊ù - ◊î◊®◊§◊™◊ß◊î ◊û◊™◊ß◊ì◊û◊™!</small>
                </button>
                <button class="difficulty-btn hard" data-difficulty="hard">
                    ü¶Å ◊°◊§◊ê◊®◊ô ◊û◊ï◊û◊ó◊î<br><small style="font-size:0.7em;">24 ◊ß◊ú◊§◊ô◊ù - ◊ê◊™◊í◊® ◊ê◊û◊ô◊™◊ô!</small>
                </button>
            </div>
        </div>

        <div class="game-screen" id="gameScreen">
            <div class="game-header">
                <div class="game-info">
                    <div class="info-card">
                        ‚è± ◊ñ◊û◊ü<br><span id="timer">00:00</span>
                    </div>
                    <div class="info-card">
                        üîÑ ◊û◊î◊ú◊õ◊ô◊ù<br><span id="moves">0</span>
                    </div>
                    <div class="info-card">
                        üéØ ◊ñ◊ï◊í◊ï◊™<br><span id="pairs">0/12</span>
                    </div>
                </div>

                <div class="stars">
                    <span class="star filled" id="star1">‚≠ê</span>
                    <span class="star filled" id="star2">‚≠ê</span>
                    <span class="star filled" id="star3">‚≠ê</span>
                </div>

                <div class="game-controls">
                    <button class="game-btn btn-home" id="homeBtn">üè† ◊ë◊ô◊™</button>
                    <button class="game-btn btn-restart" id="restartBtn">üîÑ ◊û◊©◊ó◊ß ◊ó◊ì◊©</button>
                </div>
            </div>

            <div class="game-board" id="gameBoard"></div>
        </div>
    </div>

    <div class="victory-screen" id="victoryScreen">
        <div class="victory-content">
            <div class="victory-title">üéâ ◊°◊§◊ê◊®◊ô ◊î◊ï◊©◊ú◊ù! üéâ</div>
            <div class="victory-stars" id="victoryStars">
                <span class="star">‚≠ê</span><span class="star">‚≠ê</span><span class="star">‚≠ê</span>
            </div>
            <div class="victory-stats" id="victoryStats"></div>
            <div class="victory-buttons">
                <button class="game-btn btn-restart" id="playAgainBtn">◊©◊ó◊ß ◊©◊ï◊ë</button>
                <button class="game-btn btn-home" id="chooseLevelBtn">◊ë◊ó◊® ◊®◊û◊î</button>
            </div>
        </div>
    </div>

    <div class="signature">roy.s</div>

    <script>
        const animals = {
            lion: 'ü¶Å',
            elephant: 'üêò',
            giraffe: 'ü¶í',
            zebra: 'ü¶ì',
            monkey: 'üêµ',
            tiger: 'üêÖ',
            hippo: 'ü¶õ',
            rhino: 'ü¶è',
            parrot: 'ü¶ú',
            snake: 'üêç',
            crocodile: 'üêä',
            leopard: 'üêÜ'
        };

        const animalSounds = {
            lion: 'roar',
            elephant: 'trumpet',
            giraffe: 'hum',
            zebra: 'whinny',
            monkey: 'chatter',
            tiger: 'growl',
            hippo: 'grunt',
            rhino: 'snort',
            parrot: 'squawk',
            snake: 'hiss',
            crocodile: 'snap',
            leopard: 'purr'
        };

        let gameBoard = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let moves = 0;
        let seconds = 0;
        let gameTimer = null;
        let currentDifficulty = 'easy';
        let gameStarted = false;
        let soundEnabled = true;
        let totalPairs = 6;

        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const victoryScreen = document.getElementById('victoryScreen');
        const gameBoardElement = document.getElementById('gameBoard');
        const timerElement = document.getElementById('timer');
        const movesElement = document.getElementById('moves');
        const pairsElement = document.getElementById('pairs');
        const soundToggle = document.getElementById('soundToggle');

        const difficultySettings = {
            easy: { pairs: 6, gridClass: 'easy' },
            medium: { pairs: 8, gridClass: 'medium' },
            hard: { pairs: 12, gridClass: 'hard' }
        };

        function addClickHandler(element, callback) {
            if (element) {
                element.addEventListener('click', callback);
                element.style.cursor = 'pointer';
                element.addEventListener('mousedown', function () { this.style.transform = 'scale(0.95)'; });
                element.addEventListener('mouseup', function () { this.style.transform = 'scale(1)'; });
                element.addEventListener('mouseleave', function () { this.style.transform = 'scale(1)'; });
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            soundToggle.textContent = soundEnabled ? 'üîä' : 'üîá';
            soundToggle.classList.toggle('muted', !soundEnabled);
        }

        function playSound(type, animal = null) {
            if (!soundEnabled) return;
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                switch (type) {
                    case 'flip':
                        oscillator.frequency.setValueAtTime(500, audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                        oscillator.start();
                        oscillator.stop(audioContext.currentTime + 0.2);
                        break;
                    case 'match':
                        const matchNotes = [523.25, 659.25, 783.99, 1046.50];
                        matchNotes.forEach((freq, index) => {
                            const osc = audioContext.createOscillator();
                            const gain = audioContext.createGain();
                            osc.connect(gain);
                            gain.connect(audioContext.destination);
                            osc.frequency.setValueAtTime(freq, audioContext.currentTime + index * 0.15);
                            gain.gain.setValueAtTime(0.15, audioContext.currentTime + index * 0.15);
                            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.15 + 0.5);
                            osc.start(audioContext.currentTime + index * 0.15);
                            osc.stop(audioContext.currentTime + index * 0.15 + 0.5);
                        });
                        break;
                    case 'victory':
                        const victoryNotes = [523.25, 659.25, 783.99, 1046.50, 1318.51, 1568.0];
                        victoryNotes.forEach((freq, index) => {
                            const osc = audioContext.createOscillator();
                            const gain = audioContext.createGain();
                            osc.connect(gain);
                            gain.connect(audioContext.destination);
                            osc.frequency.setValueAtTime(freq, audioContext.currentTime + index * 0.2);
                            gain.gain.setValueAtTime(0.2, audioContext.currentTime + index * 0.2);
                            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.2 + 0.6);
                            osc.start(audioContext.currentTime + index * 0.2);
                            osc.stop(audioContext.currentTime + index * 0.2 + 0.6);
                        });
                        break;
                    case 'button':
                        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                        oscillator.start();
                        oscillator.stop(audioContext.currentTime + 0.1);
                        break;
                }
            } catch (error) {
                console.log('Audio not supported');
            }
        }

        function startGame(difficulty) {
            playSound('button');
            currentDifficulty = difficulty;
            totalPairs = difficultySettings[difficulty].pairs;
            startScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            initializeGame();
        }

        function initializeGame() {
            gameStarted = false;
            flippedCards = [];
            matchedPairs = 0;
            moves = 0;
            seconds = 0;
            stopTimer();
            updateDisplay();
            createBoard();
        }

        function createBoard() {
            const animalKeys = Object.keys(animals);
            const selectedAnimals = animalKeys.slice(0, totalPairs);
            const pairs = [...selectedAnimals, ...selectedAnimals];
            gameBoard = shuffleArray(pairs);
            gameBoardElement.innerHTML = '';
            gameBoardElement.className = `game-board ${difficultySettings[currentDifficulty].gridClass}`;

            gameBoard.forEach((animal, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.index = index;
                card.dataset.animal = animal;
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-back"></div>
                        <div class="card-front">${animals[animal]}</div>
                    </div>`;
                addClickHandler(card, flipCard);
                gameBoardElement.appendChild(card);
            });
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function flipCard(event) {
            const card = event.currentTarget;
            if (card.classList.contains('flipped') || card.classList.contains('matched') || flippedCards.length >= 2) return;
            if (!gameStarted) {
                startTimer();
                gameStarted = true;
            }
            playSound('flip');
            card.classList.add('flipped');
            flippedCards.push({ card, index: parseInt(card.dataset.index), animal: card.dataset.animal });
            if (flippedCards.length === 2) {
                moves++;
                updateDisplay();
                updateStars();
                setTimeout(checkMatch, 1000);
            }
        }

        function checkMatch() {
            const [first, second] = flippedCards;
            if (!first || !second) return;
            if (first.animal === second.animal) {
                first.card.classList.add('matched');
                second.card.classList.add('matched');
                matchedPairs++;
                playSound('match', first.animal);
                updateDisplay();
                if (matchedPairs === totalPairs) {
                    setTimeout(endGame, 1000);
                }
            } else {
                setTimeout(() => {
                    first.card.classList.remove('flipped');
                    second.card.classList.remove('flipped');
                }, 500);
            }
            flippedCards = [];
        }

        function startTimer() {
            gameTimer = setInterval(() => {
                seconds++;
                updateDisplay();
            }, 1000);
        }

        function stopTimer() {
            if (gameTimer) {
                clearInterval(gameTimer);
                gameTimer = null;
            }
        }

        function updateDisplay() {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            movesElement.textContent = moves;
            pairsElement.textContent = `${matchedPairs}/${totalPairs}`;
        }

        function updateStars() {
            const stars = document.querySelectorAll('.game-screen .star');
            let starCount = 3;
            const thresholds = {
                easy: { twoStar: 15, oneStar: 25 },
                medium: { twoStar: 20, oneStar: 35 },
                hard: { twoStar: 30, oneStar: 50 }
            };
            const threshold = thresholds[currentDifficulty];
            if (moves > threshold.oneStar) starCount = 1;
            else if (moves > threshold.twoStar) starCount = 2;
            stars.forEach((star, index) => {
                star.classList.toggle('filled', index < starCount);
            });
        }

        function endGame() {
            stopTimer();
            gameStarted = false;
            playSound('victory');
            const victoryStars = document.getElementById('victoryStars').querySelectorAll('.star');
            const currentStars = document.querySelectorAll('.game-screen .star.filled').length;
            victoryStars.forEach((star, index) => {
                star.classList.toggle('filled', index < currentStars);
            });

            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            const timeStr = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            const levelName = { easy: '◊ß◊ú', medium: '◊ë◊ô◊†◊ï◊†◊ô', hard: '◊û◊ï◊û◊ó◊î' }[currentDifficulty];

            document.getElementById('victoryStats').innerHTML = `
                <div><strong>üéØ ◊®◊û◊î:</strong> ${levelName}</div>
                <div><strong>‚è± ◊ñ◊û◊ü:</strong> ${timeStr}</div>
                <div><strong>üîÑ ◊û◊î◊ú◊õ◊ô◊ù:</strong> ${moves}</div>
                <div><strong>‚≠ê ◊õ◊ï◊õ◊ë◊ô◊ù:</strong> ${currentStars}/3</div>
                <div style="margin-top: 20px; font-size: 1.3em;">
                    ${getEncouragingMessage(currentStars)}
                </div>
            `;
            victoryScreen.style.display = 'flex';
        }

        function getEncouragingMessage(stars) {
            const messages = {
                3: ["üåü ◊û◊ï◊©◊ú◊ù! ◊ê◊™◊î ◊ê◊ì◊ô◊® ◊ë◊°◊§◊ê◊®◊ô!", "üéâ ◊û◊ì◊î◊ô◊ù! ◊ñ◊ô◊õ◊®◊ï◊ü ◊ë◊®◊û◊î ◊í◊ë◊ï◊î◊î!", "üèÜ ◊ó◊ï◊ß◊® ◊û◊¶◊ï◊ô◊ü!"],
                2: ["üéä ◊¢◊ë◊ï◊ì◊î ◊†◊î◊ì◊®◊™! ◊™◊û◊©◊ô◊ö ◊õ◊ö!", "üëè ◊ò◊ï◊ë ◊û◊ê◊ï◊ì! ◊™◊™◊û◊ô◊ì!", "üåà ◊ô◊§◊î ◊û◊ê◊ï◊ì, ◊ó◊ï◊ß◊® ◊°◊§◊ê◊®◊ô!"],
                1: ["üéà ◊û◊ê◊û◊• ◊ò◊ï◊ë! ◊†◊°◊î ◊©◊ï◊ë ◊ú◊©◊§◊®!", "üí™ ◊î◊û◊©◊ö ◊ú◊ó◊ß◊ï◊®! ◊ê◊§◊©◊® ◊ò◊ï◊ë ◊ô◊ï◊™◊®!", "üå∫ ◊†◊ô◊°◊ô◊ï◊ü ◊†◊ó◊û◊ì! ◊ê◊ô◊û◊ï◊ü ◊û◊©◊§◊®."]
            };
            const messageArray = messages[stars] || messages[1];
            return messageArray[Math.floor(Math.random() * messageArray.length)];
        }

        function goHome() {
            playSound('button');
            stopTimer();
            gameScreen.style.display = 'none';
            victoryScreen.style.display = 'none';
            startScreen.style.display = 'flex';
        }

        function restartGame() {
            playSound('button');
            victoryScreen.style.display = 'none';
            initializeGame();
        }

        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                addClickHandler(btn, function () {
                    startGame(this.dataset.difficulty);
                });
            });
            addClickHandler(document.getElementById('homeBtn'), goHome);
            addClickHandler(document.getElementById('restartBtn'), restartGame);
            addClickHandler(document.getElementById('playAgainBtn'), restartGame);
            addClickHandler(document.getElementById('chooseLevelBtn'), goHome);
            addClickHandler(soundToggle, toggleSound);
        });

        document.addEventListener('keydown', function (event) {
            switch (event.key) {
                case 'Escape':
                    if (gameScreen.style.display !== 'none') goHome();
                    break;
                case 'r':
                case 'R':
                    if (gameScreen.style.display !== 'none') restartGame();
                    break;
                case 's':
                case 'S':
                    toggleSound();
                    break;
            }
        });
    </script>
</body>
</html>

